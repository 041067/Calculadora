<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadoras SENAI SP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .tab-active {
            border-color: #E53E3E;
            color: #E53E3E;
            font-weight: 600;
        }
        .calc-btn {
            transition: all 0.2s ease-in-out;
        }
        .calc-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .calc-btn:active {
            transform: scale(0.95);
        }
        #sci-display {
            text-align: right;
            padding: 1rem;
            font-size: 2.5rem;
            overflow-x: auto;
            white-space: nowrap;
        }
        @media screen and (max-width: 640px) {
            #sci-display {
            font-size: 1.2rem;
            padding: 0.5rem;
            }
            .calc-btn {
            font-size: 1rem;
            padding: 0.5rem;
            }
            .p-6 {
            padding: 0.5rem !important;
            }
            input, label, button {
            font-size: 1rem !important;
            }
            .max-w-2xl {
            max-width: 100vw !important;
            }
            header img {
            height: 2.5rem;
            }
            .grid {
            gap: 0.5rem;
            }
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
        <header class="bg-red-700 p-6 flex flex-col sm:flex-row items-center justify-between text-white">
            <div class="flex flex-col items-center">
                <img src="/img/sesi-senai.png" alt="banner" class="h-16 mb-2" onerror="this.style.display='none'">
            </div>
            <div class="text-center">
                <h1 class="text-2xl font-bold">Central de Calculadoras</h1>
                <p class="text-red-200">Ferramentas para seus cálculos</p>
            </div>
        </header>

        <nav class="flex border-b">
            <button class="flex-1 p-4 text-center text-gray-600 border-b-4 border-transparent tab-active" onclick="showCalculator('scientific')">Científica</button>
            <button class="flex-1 p-4 text-center text-gray-600 border-b-4 border-transparent" onclick="showCalculator('financial')">Financeira</button>
            <button class="flex-1 p-4 text-center text-gray-600 border-b-4 border-transparent" onclick="showCalculator('matrix')">Matriz</button>
        </nav>

        <main class="p-6">
            <div id="scientific-calculator">
                <div class="bg-gray-200 rounded-lg mb-4 text-gray-800">
                    <input type="text" id="sci-display" class="w-full bg-transparent border-none focus:ring-0" value="0" readonly>
                </div>
                 <div class="grid grid-cols-5 gap-2 text-xl">
                    
                    <button onclick="sciCalcFunc('sin')" class="calc-btn bg-gray-300 p-4 rounded-lg">sin</button>
                    <button onclick="sciCalcFunc('cos')" class="calc-btn bg-gray-300 p-4 rounded-lg">cos</button>
                    <button onclick="sciCalcFunc('tan')" class="calc-btn bg-gray-300 p-4 rounded-lg">tan</button>
                    <button onclick="sciCalcFunc('log')" class="calc-btn bg-gray-300 p-4 rounded-lg">log</button>
                    <button onclick="sciCalcFunc('sqrt')" class="calc-btn bg-gray-300 p-4 rounded-lg">√</button>

                    <button onclick="sciAppend('(')" class="calc-btn bg-gray-300 p-4 rounded-lg">(</button>
                    <button onclick="sciAppend(')')" class="calc-btn bg-gray-300 p-4 rounded-lg">)</button>
                    <button onclick="sciCalcFunc('pow')" class="calc-btn bg-gray-300 p-4 rounded-lg">xʸ</button>
                    <button onclick="sciClear()" class="calc-btn bg-yellow-500 text-white col-span-2 p-4 rounded-lg">C</button>
                    
                    
                    <button onclick="sciAppend('7')" class="calc-btn bg-gray-100 p-4 rounded-lg">7</button>
                    <button onclick="sciAppend('8')" class="calc-btn bg-gray-100 p-4 rounded-lg">8</button>
                    <button onclick="sciAppend('9')" class="calc-btn bg-gray-100 p-4 rounded-lg">9</button>
                    <button onclick="sciAppend('/')" class="calc-btn bg-red-500 text-white p-4 rounded-lg">÷</button>
                    <button onclick="sciBackspace()" class="calc-btn bg-yellow-500 text-white p-4 rounded-lg">⌫</button>

                    <button onclick="sciAppend('4')" class="calc-btn bg-gray-100 p-4 rounded-lg">4</button>
                    <button onclick="sciAppend('5')" class="calc-btn bg-gray-100 p-4 rounded-lg">5</button>
                    <button onclick="sciAppend('6')" class="calc-btn bg-gray-100 p-4 rounded-lg">6</button>
                    <button onclick="sciAppend('*')" class="calc-btn bg-red-500 text-white p-4 rounded-lg">×</button>
                    <button onclick="sciAppend('%')" class="calc-btn bg-red-500 text-white p-4 rounded-lg">%</button>
                    
                    <button onclick="sciAppend('1')" class="calc-btn bg-gray-100 p-4 rounded-lg">1</button>
                    <button onclick="sciAppend('2')" class="calc-btn bg-gray-100 p-4 rounded-lg">2</button>
                    <button onclick="sciAppend('3')" class="calc-btn bg-gray-100 p-4 rounded-lg">3</button>
                    <button onclick="sciAppend('-')" class="calc-btn bg-red-500 text-white p-4 rounded-lg">−</button>
                    <button onclick="sciCalculate()" class="calc-btn bg-red-700 text-white row-span-2 p-4 rounded-lg">=</button>
                    
                    <button onclick="sciAppend('0')" class="calc-btn bg-gray-100 col-span-2 p-4 rounded-lg">0</button>
                    <button onclick="sciAppend('.')" class="calc-btn bg-gray-100 p-4 rounded-lg">.</button>
                    <button onclick="sciAppend('+')" class="calc-btn bg-red-500 text-white p-4 rounded-lg">+</button>
                </div>
            </div>

            <div id="financial-calculator" class="hidden">
                 <div class="space-y-4">
                    <p class="text-sm text-gray-600 text-center">Preencha quatro dos cinco campos e clique em 'Calcular' para encontrar o valor do campo restante.</p>
                    
                    <div class="flex items-center space-x-2">
                        <label for="fin-n" class="w-24 text-gray-700">N (Períodos)</label>
                        <input type="number" id="fin-n" class="flex-1 p-2 border rounded-md focus:ring-red-500 focus:border-red-500">
                        <button onclick="calculateFinancial('n')" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">Calcular</button>
                    </div>
                     <div class="flex items-center space-x-2">
                        <label for="fin-iy" class="w-24 text-gray-700">I/Y (Juros %)</label>
                        <input type="number" id="fin-iy" class="flex-1 p-2 border rounded-md focus:ring-red-500 focus:border-red-500">
                        <button onclick="calculateFinancial('iy')" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">Calcular</button>
                    </div>
                     <div class="flex items-center space-x-2">
                        <label for="fin-pv" class="w-24 text-gray-700">VP (Valor Pres.)</label>
                        <input type="number" id="fin-pv" class="flex-1 p-2 border rounded-md focus:ring-red-500 focus:border-red-500">
                        <button onclick="calculateFinancial('pv')" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">Calcular</button>
                    </div>
                    <div class="flex items-center space-x-2">
                        <label for="fin-pmt" class="w-24 text-gray-700">PMT (Pagamento)</label>
                        <input type="number" id="fin-pmt" class="flex-1 p-2 border rounded-md focus:ring-red-500 focus:border-red-500">
                        <button onclick="calculateFinancial('pmt')" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">Calcular</button>
                    </div>
                    <div class="flex items-center space-x-2">
                        <label for="fin-fv" class="w-24 text-gray-700">VF (Valor Fut.)</label>
                        <input type="number" id="fin-fv" class="flex-1 p-2 border rounded-md focus:ring-red-500 focus:border-red-500">
                        <button onclick="calculateFinancial('fv')" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">Calcular</button>
                    </div>
                    <button onclick="clearFinancial()" class="w-full py-3 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 mt-4">Limpar Tudo</button>

                    <div id="financial-calculation-steps" class="mt-4 p-4 bg-gray-100 rounded-lg hidden">
                        <h4 class="font-semibold text-gray-700">Passo a Passo do Cálculo:</h4>
                        <p class="text-gray-600 text-sm mt-2 break-words" id="financial-formula"></p>
                        <p class="text-red-700 font-bold text-lg mt-1" id="financial-result-breakdown"></p>
                    </div>
                 </div>
            </div>

            <div id="matrix-calculator" class="hidden">
                <div class="space-y-6">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">Determinante de Matriz 2x2</h3>
                        <div class="grid grid-cols-2 gap-2 max-w-xs mx-auto">
                            <input type="number" id="m2_00" class="p-2 border rounded-md text-center" placeholder="a">
                            <input type="number" id="m2_01" class="p-2 border rounded-md text-center" placeholder="b">
                            <input type="number" id="m2_10" class="p-2 border rounded-md text-center" placeholder="c">
                            <input type="number" id="m2_11" class="p-2 border rounded-md text-center" placeholder="d">
                        </div>
                        <button onclick="calculateDeterminant(2)" class="w-full mt-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">Calcular Determinante 2x2</button>
                    </div>
                    
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-2">Determinante de Matriz 3x3 (Método de Cramer)</h3>
                        <div class="grid grid-cols-3 gap-2 max-w-xs mx-auto">
                            <input type="number" id="m3_00" class="p-2 border rounded-md text-center" placeholder="a">
                            <input type="number" id="m3_01" class="p-2 border rounded-md text-center" placeholder="b">
                            <input type="number" id="m3_02" class="p-2 border rounded-md text-center" placeholder="c">
                            <input type="number" id="m3_10" class="p-2 border rounded-md text-center" placeholder="d">
                            <input type="number" id="m3_11" class="p-2 border rounded-md text-center" placeholder="e">
                            <input type="number" id="m3_12" class="p-2 border rounded-md text-center" placeholder="f">
                            <input type="number" id="m3_20" class="p-2 border rounded-md text-center" placeholder="g">
                            <input type="number" id="m3_21" class="p-2 border rounded-md text-center" placeholder="h">
                            <input type="number" id="m3_22" class="p-2 border rounded-md text-center" placeholder="i">
                        </div>
                        <button onclick="calculateDeterminant(3)" class="w-full mt-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700">Calcular Determinante 3x3</button>
                    </div>

                    <div class="text-center bg-gray-100 p-4 rounded-lg">
                        <h4 class="text-gray-600">Cálculo e Resultado:</h4>
                        <p id="determinant-steps" class="text-sm text-gray-600 break-words">Nenhum cálculo realizado.</p>
                        <p id="determinant-result" class="text-2xl font-bold text-red-700 mt-2">0</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const calculators = {
            scientific: document.getElementById('scientific-calculator'),
            financial: document.getElementById('financial-calculator'),
            matrix: document.getElementById('matrix-calculator'),
        };
        const tabs = document.querySelectorAll('nav button');

        function showCalculator(type) {
            for (const key in calculators) {
                calculators[key].classList.add('hidden');
            }
            tabs.forEach(tab => tab.classList.remove('tab-active'));

            calculators[type].classList.remove('hidden');
            document.querySelector(`button[onclick="showCalculator('${type}')"]`).classList.add('tab-active');
        }
        const sciDisplay = document.getElementById('sci-display');
        let currentInput = '0';
        let operatorUsed = false;

        function sciAppend(value) {
            if (currentInput === '0' && value !== '.') {
                currentInput = '';
            }

            const lastChar = currentInput.slice(-1);
            const isOperator = ['+', '-', '*', '/'].includes(value);
            const lastCharIsOperator = ['+', '-', '*', '/'].includes(lastChar);

            if (isOperator && lastCharIsOperator) {
                currentInput = currentInput.slice(0, -1) + value;
            } else {
                currentInput += value;
            }
            
            sciDisplay.value = currentInput;
        }

        function sciClear() {
            currentInput = '0';
            operatorUsed = false;
            sciDisplay.value = currentInput;
        }

        function sciBackspace() {
            if (currentInput.length > 1) {
                currentInput = currentInput.slice(0, -1);
            } else {
                currentInput = '0';
            }
            sciDisplay.value = currentInput;
        }

        function sciCalculate() {
            try {
                let expression = currentInput.replace(/√/g, 'Math.sqrt').replace(/\^/g, '**');
                let result = new Function('return ' + expression)();
                sciDisplay.value = result;
                currentInput = result.toString();
                operatorUsed = false;
            } catch (error) {
                sciDisplay.value = 'Erro';
                currentInput = '0';
            }
        }
        
        function sciCalcFunc(func) {
             try {
                let val = parseFloat(new Function('return ' + currentInput)());
                let result;
                switch(func) {
                    case 'sin': result = Math.sin(val * Math.PI / 180); break; 
                    case 'cos': result = Math.cos(val * Math.PI / 180); break;
                    case 'tan': result = Math.tan(val * Math.PI / 180); break;
                    case 'log': result = Math.log10(val); break;
                    case 'sqrt': result = Math.sqrt(val); break;
                    case 'pow': currentInput += '**'; sciDisplay.value = currentInput; return;
                }
                sciDisplay.value = result;
                currentInput = result.toString();
            } catch(e) {
                sciDisplay.value = "Erro";
                currentInput = '0';
            }
        }
        const finInputs = {
            n: document.getElementById('fin-n'),
            iy: document.getElementById('fin-iy'),
            pv: document.getElementById('fin-pv'),
            pmt: document.getElementById('fin-pmt'),
            fv: document.getElementById('fin-fv'),
        };
        const finStepsContainer = document.getElementById('financial-calculation-steps');
        const finFormulaEl = document.getElementById('financial-formula');
        const finBreakdownEl = document.getElementById('financial-result-breakdown');


        function getFinValues() {
            const values = {};
            for (const key in finInputs) {
                values[key] = finInputs[key].value === '' ? null : parseFloat(finInputs[key].value);
            }
            return values;
        }
        
        function calculateFinancial(toCalculate) {
            const values = getFinValues();
            const { n, pv, pmt, fv } = values;
            const iy = values.iy !== null ? values.iy / 100 : null; // Taxa como decimal
            
            try {
                let result, formula, breakdown;
                switch(toCalculate) {
                    case 'fv':
                        if (n === null || iy === null || pv === null || pmt === null) throw new Error("Campos insuficientes");
                        result = -(pv * Math.pow(1 + iy, n) + pmt * (Math.pow(1 + iy, n) - 1) / iy);
                        formula = "VF = -[VP * (1 + i)^N + PMT * (((1 + i)^N - 1) / i)]";
                        breakdown = `VF = -[${pv} * (1 + ${iy})^${n} + ${pmt} * (((1 + ${iy})^${n} - 1) / ${iy})]`;
                        break;
                    case 'pv':
                        if (n === null || iy === null || pmt === null || fv === null) throw new Error("Campos insuficientes");
                        result = -(fv + pmt * (Math.pow(1 + iy, n) - 1) / iy) / Math.pow(1 + iy, n);
                        formula = "VP = -[VF + PMT * ((1+i)^N - 1)/i] / (1+i)^N";
                        breakdown = `VP = -[${fv} + ${pmt} * ((1+${iy})^${n} - 1)/${iy}] / (1+${iy})^${n}`;
                        break;
                    case 'pmt':
                        if (n === null || iy === null || pv === null || fv === null) throw new Error("Campos insuficientes");
                        result = -(pv * Math.pow(1 + iy, n) + fv) / ((Math.pow(1 + iy, n) - 1) / iy);
                        formula = "PMT = -[VP * (1+i)^N + VF] / [((1+i)^N - 1)/i]";
                        breakdown = `PMT = -[${pv} * (1+${iy})^${n} + ${fv}] / [((1+${iy})^${n} - 1)/${iy}]`;
                        break;
                    case 'n':
                        if (iy === null || pv === null || pmt === null || fv === null) throw new Error("Campos insuficientes");
                         result = Math.log((-fv * iy + pmt) / (pv * iy + pmt)) / Math.log(1 + iy);
                         formula = "N = log((-VF*i + PMT) / (VP*i + PMT)) / log(1 + i)";
                         breakdown = `N = log((-${fv}*${iy} + ${pmt}) / (${pv}*${iy} + ${pmt})) / log(1 + ${iy})`;
                        break;
                    case 'iy':
                         alert("O cálculo de I/Y é complexo e não está implementado nesta versão simplificada.");
                         return;
                }
                 finInputs[toCalculate].value = result.toFixed(2);
                 finInputs[toCalculate].classList.add('bg-yellow-200');
                 
                 finFormulaEl.innerText = formula;
                 finBreakdownEl.innerText = `${breakdown} = ${result.toFixed(2)}`;
                 finStepsContainer.classList.remove('hidden');

            } catch(e) {
                alert('Erro: Verifique os campos. Você precisa preencher 4 dos 5 campos para calcular o restante.');
                finStepsContainer.classList.add('hidden');
            }
        }

        function clearFinancial() {
            for (const key in finInputs) {
                finInputs[key].value = '';
                finInputs[key].classList.remove('bg-yellow-200');
            }
            finStepsContainer.classList.add('hidden');
        }
        
        function getMatrixValues(size) {
            const matrix = [];
            for (let i = 0; i < size; i++) {
                matrix[i] = [];
                for (let j = 0; j < size; j++) {
                    const val = parseFloat(document.getElementById(`m${size}_${i}${j}`).value);
                    if (isNaN(val)) {
                        alert(`Por favor, preencha todos os campos da matriz ${size}x${size}.`);
                        return null;
                    }
                    matrix[i][j] = val;
                }
            }
            return matrix;
        }

        function calculateDeterminant(size) {
            const matrix = getMatrixValues(size);
            if (!matrix) return;

            let det = 0;
            let steps = '';
            if (size === 2) {
                const [a, b] = matrix[0];
                const [c, d] = matrix[1];
                det = a * d - b * c;
                steps = `(${a} * ${d}) - (${b} * ${c})`;
            } else if (size === 3) {
                const [a, b, c] = matrix[0];
                const [d, e, f] = matrix[1];
                const [g, h, i] = matrix[2];
                det = a * (e * i - f * h) - b * (d * i - f * g) + c * (d * h - e * g);
                steps = `(${a}*${e}*${i} + ${b}*${f}*${g} + ${c}*${d}*${h}) - (${g}*${e}*${c} + ${h}*${f}*${a} + ${i}*${d}*${b})`;
            }
            document.getElementById('determinant-steps').innerText = steps;
            document.getElementById('determinant-result').innerText = det;
        }

    </script>
</body>
</html>